}
map_df <- st_as_sf(map)
map_df$id <- 1:N_reg
map_df$value <- value
if (commom_legend) {
min_legend <- min(c(M, L, U)) * 0.975
max_legend <- max(c(M, L, U)) * 1.025
} else {
min_legend <- min(map_df$value) * 0.975
max_legend <- max(map_df$value) * 1.025
}
p <- ggplot(data = map_df) +
geom_sf(aes(fill = value), color = "gray", size = 0.25) +
scale_fill_viridis(limits = c(min_legend, max_legend), name = title, option = "inferno") +
theme_bw() +
labs(x = "Longitude", y = "Latitude", title = title) +
theme(text = element_text(family = 'LM Roman 10'))
p
}
par(family = 'LM Roman 10', mfrow = c(1, 3))
pL <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "L", title = "Net Survival (.025)", commom_legend = T)
pM <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "M", title = "Net Survival (mean)", commom_legend = T)
pU <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "U", title = "Net Survival (.975)", commom_legend = T)
grid.arrange(pL, pM, pU, nrow = 1, ncol = 3)
source("header.R")
data <- readRDS(file = "DATA/leuk.rds")
# Optional
data$age <- scale(data$age)
data$wbc <- scale(data$wbc)
data$dep <- scale(data$dep)
map <- readRDS(file = "DATA/nwengland_map.rds")
adj_info <- adj_list(map = map)
model <- "LN_ABDD"
dist <- gsub(pattern = "_", replacement = "", x = substring(text = model, first = c(1, 4), last = c(3, 7))[1])
d <- data_stan(data = data, model = model, cov.tilde = c("age"), cov = c("age", "wbc", "sex", "dep"), nonlinear = c(), adj_info = adj_info)
r <- fit_stan(data = d, model = model)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
fit_stan <- function (data, model, chains = 4, iter = 4e3, warmup = 2e3, adapt_delta = 0.8, max_treedepth = 10, ...) {
if (!validate_model(model = model)) {
stop("Select a valid model.")
}
original_model <- model
name  <- substring(text = model, first = c(1, 4), last = c(3, 7))
dist  <- gsub(pattern = "_", replacement = "", x = name[1])
model <- name[2]
if (model == "ABDD") { model <- "ABCC" }
if (model == "AADD" | model == "BBCC" | model == "BBDD") { model <- "AACC" }
if (model == "ABTT") { model <- "ABSS" }
if (model == "AATT" | model == "BBSS" | model == "BBTT") { model <- "AASS" }
if (model == "BBXX") { model <- "AAXX" }
chains <- chains
iter <- iter
warmup <- warmup
start_time <- Sys.time()
fit <- stan(file = paste("MODELS/", dist, "/", original_model, ".stan", sep = ""),
data = data,
chains = chains,
iter = iter,
warmup = warmup,
pars = c("lp_tilde", "lp", "excessHaz", "cumExcessHaz"),
include = F,
control = list(adapt_delta = adapt_delta, max_treedepth = max_treedepth),
cores = getOption(x = "mc.cores", default = detectCores()))
end_time <- Sys.time()
time_taken <- end_time - start_time
list(model = original_model, chains = chains, iter = iter, warmup = warmup, adapt_delta = adapt_delta, max_treedepth = max_treedepth, fit = fit, time_taken = time_taken)
}
source("header.R")
data <- readRDS(file = "DATA/leuk.rds")
# Optional
data$age <- scale(data$age)
data$wbc <- scale(data$wbc)
data$dep <- scale(data$dep)
map <- readRDS(file = "DATA/nwengland_map.rds")
adj_info <- adj_list(map = map)
model <- "LN_ABDD"
dist <- gsub(pattern = "_", replacement = "", x = substring(text = model, first = c(1, 4), last = c(3, 7))[1])
d <- data_stan(data = data, model = model, cov.tilde = c("age"), cov = c("age", "wbc", "sex", "dep"), nonlinear = c(), adj_info = adj_info)
r <- fit_stan(data = d, model = model)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
fit_stan <- function (data, model, chains = 4, iter = 4e3, warmup = 2e3, adapt_delta = 0.8, max_treedepth = 10, ...) {
if (!validate_model(model = model)) {
stop("Select a valid model.")
}
original_model <- model
name  <- substring(text = model, first = c(1, 4), last = c(3, 7))
dist  <- name[1]
model <- name[2]
if (model == "ABDD") { model <- "ABCC" }
if (model == "AADD" | model == "BBCC" | model == "BBDD") { model <- "AACC" }
if (model == "ABTT") { model <- "ABSS" }
if (model == "AATT" | model == "BBSS" | model == "BBTT") { model <- "AASS" }
if (model == "BBXX") { model <- "AAXX" }
chains <- chains
iter <- iter
warmup <- warmup
start_time <- Sys.time()
fit <- stan(file = paste("MODELS/", gsub(pattern = "_", replacement = "", x = dist), "/", dist, model, ".stan", sep = ""),
data = data,
chains = chains,
iter = iter,
warmup = warmup,
pars = c("lp_tilde", "lp", "excessHaz", "cumExcessHaz"),
include = F,
control = list(adapt_delta = adapt_delta, max_treedepth = max_treedepth),
cores = getOption(x = "mc.cores", default = detectCores()))
end_time <- Sys.time()
time_taken <- end_time - start_time
list(model = original_model, chains = chains, iter = iter, warmup = warmup, adapt_delta = adapt_delta, max_treedepth = max_treedepth, fit = fit, time_taken = time_taken)
}
source("header.R")
data <- readRDS(file = "DATA/leuk.rds")
# Optional
data$age <- scale(data$age)
data$wbc <- scale(data$wbc)
data$dep <- scale(data$dep)
map <- readRDS(file = "DATA/nwengland_map.rds")
adj_info <- adj_list(map = map)
model <- "LN_ABDD"
dist <- gsub(pattern = "_", replacement = "", x = substring(text = model, first = c(1, 4), last = c(3, 7))[1])
d <- data_stan(data = data, model = model, cov.tilde = c("age"), cov = c("age", "wbc", "sex", "dep"), nonlinear = c(), adj_info = adj_info)
r <- fit_stan(data = d, model = model)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
# saveRDS(object = fit, file = paste("FITTED_MODELS/", dist, "/", model, ".rds", sep = ""))
## Model comparison
loo <- compute_loo(fit = fit)
# loo_compare(list(M1 = loo1, M2 = loo2))
bridge <- bridge_sampler(samples = fit, cores = getOption(x = "mc.cores", default = detectCores()), silent = T)
# bayes_factor(x1 = bridge1, x2 = bridge2)
# saveRDS(object = bridge, file = paste("FITTED_MODELS/", dist, "/bridge_", model, ".rds", sep = ""))
## Result processing
time <- seq(from = 0.025, to = 4, by = 0.025)
mu_age <- attr(x = data$age, which = "scaled:center")
sd_age <- attr(x = data$age, which = "scaled:scale")
age <- 40 + time
age <- (age - mu_age) / sd_age
X_tilde <- matrix(data = c(age), ncol = 1, byrow = F)
X <- matrix(data = c(age, rep(1, length(time)), rep(0.5, length(time)), rep(1.2, length(time))), ncol = 4, byrow = F)
res <- result_processing(fit = fit, model = model, time = time, X_tilde = X_tilde, X = X)
excHaz    <- res$excHaz
excCumHaz <- res$excCumHaz
netSur    <- res$netSur
rstan:::rstudio_stanc("MODELS/stan_functions.stan")
region <- 1
par(family = 'LM Roman 10', mfrow = c(1, 1))
plot_summary_curve(time = time, obj = excHaz, region = region, ylab = "Excess Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = excCumHaz, region = region, ylab = "Excess Cumulative Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = netSur, region = region, dist = dist, return_values = T)
par(family = 'LM Roman 10', mfrow = c(1, 3))
pL <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "L", title = "Net Survival (.025)", commom_legend = T)
pM <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "M", title = "Net Survival (mean)", commom_legend = T)
pU <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "U", title = "Net Survival (.975)", commom_legend = T)
grid.arrange(pL, pM, pU, nrow = 1, ncol = 3)
pL <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "L", title = "Net Survival (.025)", commom_legend = T)
pM <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "M", title = "Net Survival (mean)", commom_legend = F)
pU <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "U", title = "Net Survival (.975)", commom_legend = T)
grid.arrange(pL, pM, pU, nrow = 1, ncol = 3)
source("header.R")
data <- readRDS(file = "DATA/leuk.rds")
# Optional
data$age <- scale(data$age)
data$wbc <- scale(data$wbc)
data$dep <- scale(data$dep)
map <- readRDS(file = "DATA/nwengland_map.rds")
adj_info <- adj_list(map = map)
model <- "LN_ABDD"
dist <- gsub(pattern = "_", replacement = "", x = substring(text = model, first = c(1, 4), last = c(3, 7))[1])
d <- data_stan(data = data, model = model, cov.tilde = c("age"), cov = c("age", "wbc", "sex", "dep"), nonlinear = c(), adj_info = adj_info)
r <- fit_stan(data = d, model = model)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
# saveRDS(object = fit, file = paste("FITTED_MODELS/", dist, "/", model, ".rds", sep = ""))
source("header.R")
data <- readRDS(file = "DATA/leuk.rds")
# Optional
data$age <- scale(data$age)
data$wbc <- scale(data$wbc)
data$dep <- scale(data$dep)
map <- readRDS(file = "DATA/nwengland_map.rds")
adj_info <- adj_list(map = map)
model <- "LN_ABDD"
dist <- gsub(pattern = "_", replacement = "", x = substring(text = model, first = c(1, 4), last = c(3, 7))[1])
d <- data_stan(data = data, model = model, cov.tilde = c("age"), cov = c("age", "wbc", "sex", "dep"), nonlinear = c(), adj_info = adj_info)
r <- fit_stan(data = d, model = model)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
## Model comparison
loo <- compute_loo(fit = fit)
print(loo)
time <- seq(from = 0.025, to = 4, by = 0.025)
mu_age <- attr(x = data$age, which = "scaled:center")
sd_age <- attr(x = data$age, which = "scaled:scale")
age <- 40 + time
age <- (age - mu_age) / sd_age
X_tilde <- matrix(data = c(age), ncol = 1, byrow = F)
X <- matrix(data = c(age, rep(1, length(time)), rep(0.5, length(time)), rep(1.2, length(time))), ncol = 4, byrow = F)
res <- result_processing(fit = fit, model = model, time = time, X_tilde = X_tilde, X = X)
excHaz    <- res$excHaz
excCumHaz <- res$excCumHaz
netSur    <- res$netSur
plot_summary_curve(time = time, obj = excHaz, region = region, ylab = "Excess Hazard", dist = dist, return_values = T)
region <- 1
par(family = 'LM Roman 10', mfrow = c(1, 1))
plot_summary_curve(time = time, obj = excHaz, region = region, ylab = "Excess Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = excCumHaz, region = region, ylab = "Excess Cumulative Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = netSur, region = region, dist = dist, return_values = T)
par(family = 'LM Roman 10', mfrow = c(1, 3))
pL <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "L", title = "Net Survival (.025)", commom_legend = T)
pM <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "M", title = "Net Survival (mean)", commom_legend = T)
pU <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "U", title = "Net Survival (.975)", commom_legend = T)
grid.arrange(pL, pM, pU, nrow = 1, ncol = 3)
source("header.R")
data <- readRDS(file = "DATA/leuk.rds")
# Optional
data$age <- scale(data$age)
data$wbc <- scale(data$wbc)
data$dep <- scale(data$dep)
map <- readRDS(file = "DATA/nwengland_map.rds")
adj_info <- adj_list(map = map)
model <- "LL_ABDD"
dist <- gsub(pattern = "_", replacement = "", x = substring(text = model, first = c(1, 4), last = c(3, 7))[1])
d <- data_stan(data = data, model = model, cov.tilde = c("age"), cov = c("age", "wbc", "sex", "dep"), nonlinear = c(), adj_info = adj_info)
r <- fit_stan(data = d, model = model)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
# saveRDS(object = fit, file = paste("FITTED_MODELS/", dist, "/", model, ".rds", sep = ""))
## Model comparison
loo <- compute_loo(fit = fit)
# loo_compare(list(M1 = loo1, M2 = loo2))
bridge <- bridge_sampler(samples = fit, cores = getOption(x = "mc.cores", default = detectCores()), silent = T)
# bayes_factor(x1 = bridge1, x2 = bridge2)
# saveRDS(object = bridge, file = paste("FITTED_MODELS/", dist, "/bridge_", model, ".rds", sep = ""))
## Result processing
time <- seq(from = 0.025, to = 4, by = 0.025)
mu_age <- attr(x = data$age, which = "scaled:center")
sd_age <- attr(x = data$age, which = "scaled:scale")
age <- 40 + time
age <- (age - mu_age) / sd_age
X_tilde <- matrix(data = c(age), ncol = 1, byrow = F)
X <- matrix(data = c(age, rep(1, length(time)), rep(0.5, length(time)), rep(1.2, length(time))), ncol = 4, byrow = F)
res <- result_processing(fit = fit, model = model, time = time, X_tilde = X_tilde, X = X)
excHaz    <- res$excHaz
excCumHaz <- res$excCumHaz
netSur    <- res$netSur
## Visualization
region <- 1
par(family = 'LM Roman 10', mfrow = c(1, 1))
plot_summary_curve(time = time, obj = excHaz, region = region, ylab = "Excess Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = excCumHaz, region = region, ylab = "Excess Cumulative Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = netSur, region = region, dist = dist, return_values = T)
plot_all_regions(time = time, obj = excHaz, N_reg = N_reg, ylab = "Excess Hazard", dist = dist, return_values = T)
plot_all_regions(time = time, obj = excCumHaz, N_reg = N_reg, ylab = "Excess Cumulative Hazard", dist = dist, pos_legend = "topleft", return_values = T)
plot_all_regions(time = time, obj = netSur, N_reg = N_reg, dist = dist, return_values = T)
par(family = 'LM Roman 10', mfrow = c(1, 3))
pL <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "L", title = "Net Survival (.025)", commom_legend = T)
pM <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "M", title = "Net Survival (mean)", commom_legend = T)
pU <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "U", title = "Net Survival (.975)", commom_legend = T)
grid.arrange(pL, pM, pU, nrow = 1, ncol = 3)
grid.arrange(pL, pM, pU, nrow = 1, ncol = 3)
par(family = 'LM Roman 10', mfrow = c(1, 3))
pL <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "L", title = "Net Survival (.025)", commom_legend = T)
pM <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "M", title = "Net Survival (mean)", commom_legend = T)
pU <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "U", title = "Net Survival (.975)", commom_legend = T)
grid.arrange(pL, pM, pU, nrow = 1, ncol = 3)
rstan:::rstudio_stanc("MODELS/stan_functions.stan")
rstan:::rstudio_stanc("MODELS/stan_functions.stan")
rstan:::rstudio_stanc("MODELS/stan_functions.stan")
source("header.R")
data <- readRDS(file = "DATA/leuk.rds")
# Optional
data$age <- scale(data$age)
data$wbc <- scale(data$wbc)
data$dep <- scale(data$dep)
map <- readRDS(file = "DATA/nwengland_map.rds")
adj_info <- adj_list(map = map)
model <- "LL_ABCD"
dist <- gsub(pattern = "_", replacement = "", x = substring(text = model, first = c(1, 4), last = c(3, 7))[1])
d <- data_stan(data = data, model = model, cov.tilde = c("age"), cov = c("age", "wbc", "sex", "dep"), nonlinear = c(), adj_info = adj_info)
r <- fit_stan(data = d, model = model)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
# saveRDS(object = fit, file = paste("FITTED_MODELS/", dist, "/", model, ".rds", sep = ""))
## Model comparison
loo <- compute_loo(fit = fit)
# loo_compare(list(M1 = loo1, M2 = loo2))
bridge <- bridge_sampler(samples = fit, cores = getOption(x = "mc.cores", default = detectCores()), silent = T)
# bayes_factor(x1 = bridge1, x2 = bridge2)
# saveRDS(object = bridge, file = paste("FITTED_MODELS/", dist, "/bridge_", model, ".rds", sep = ""))
## Result processing
time <- seq(from = 0.025, to = 4, by = 0.025)
mu_age <- attr(x = data$age, which = "scaled:center")
sd_age <- attr(x = data$age, which = "scaled:scale")
age <- 40 + time
age <- (age - mu_age) / sd_age
X_tilde <- matrix(data = c(age), ncol = 1, byrow = F)
X <- matrix(data = c(age, rep(1, length(time)), rep(0.5, length(time)), rep(1.2, length(time))), ncol = 4, byrow = F)
res <- result_processing(fit = fit, model = model, time = time, X_tilde = X_tilde, X = X)
excHaz    <- res$excHaz
excCumHaz <- res$excCumHaz
netSur    <- res$netSur
## Visualization
region <- 1
par(family = 'LM Roman 10', mfrow = c(1, 1))
region <- 1
par(family = 'LM Roman 10', mfrow = c(1, 1))
plot_summary_curve(time = time, obj = excHaz, region = region, ylab = "Excess Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = excCumHaz, region = region, ylab = "Excess Cumulative Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = netSur, region = region, dist = dist, return_values = T)
plot_all_regions(time = time, obj = excHaz, N_reg = N_reg, ylab = "Excess Hazard", dist = dist, return_values = T)
plot_all_regions(time = time, obj = excCumHaz, N_reg = N_reg, ylab = "Excess Cumulative Hazard", dist = dist, pos_legend = "topleft", return_values = T)
plot_all_regions(time = time, obj = netSur, N_reg = N_reg, dist = dist, return_values = T)
par(family = 'LM Roman 10', mfrow = c(1, 3))
pL <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "L", title = "Net Survival (.025)", commom_legend = T)
pM <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "M", title = "Net Survival (mean)", commom_legend = T)
pU <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "U", title = "Net Survival (.975)", commom_legend = T)
grid.arrange(pL, pM, pU, nrow = 1, ncol = 3)
r$time_taken
source("header.R")
data <- readRDS(file = "DATA/leuk.rds")
# Optional
data$age <- scale(data$age)
data$wbc <- scale(data$wbc)
data$dep <- scale(data$dep)
map <- readRDS(file = "DATA/nwengland_map.rds")
adj_info <- adj_list(map = map)
model <- "LL_ABST"
dist <- gsub(pattern = "_", replacement = "", x = substring(text = model, first = c(1, 4), last = c(3, 7))[1])
d <- data_stan(data = data, model = model, cov.tilde = c("age"), cov = c("age", "wbc", "sex", "dep"), nonlinear = c(), adj_info = adj_info)
r <- fit_stan(data = d, model = model)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
## Model comparison
loo <- compute_loo(fit = fit)
# loo_compare(list(M1 = loo1, M2 = loo2))
bridge <- bridge_sampler(samples = fit, cores = getOption(x = "mc.cores", default = detectCores()), silent = T)
# bayes_factor(x1 = bridge1, x2 = bridge2)
# saveRDS(object = bridge, file = paste("FITTED_MODELS/", dist, "/bridge_", model, ".rds", sep = ""))
## Result processing
time <- seq(from = 0.025, to = 4, by = 0.025)
mu_age <- attr(x = data$age, which = "scaled:center")
sd_age <- attr(x = data$age, which = "scaled:scale")
age <- 40 + time
age <- (age - mu_age) / sd_age
X_tilde <- matrix(data = c(age), ncol = 1, byrow = F)
X <- matrix(data = c(age, rep(1, length(time)), rep(0.5, length(time)), rep(1.2, length(time))), ncol = 4, byrow = F)
res <- result_processing(fit = fit, model = model, time = time, X_tilde = X_tilde, X = X)
excHaz    <- res$excHaz
excCumHaz <- res$excCumHaz
netSur    <- res$netSur
## Visualization
region <- 1
par(family = 'LM Roman 10', mfrow = c(1, 1))
plot_summary_curve(time = time, obj = excHaz, region = region, ylab = "Excess Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = excCumHaz, region = region, ylab = "Excess Cumulative Hazard", dist = dist, return_values = T)
plot_summary_curve(time = time, obj = netSur, region = region, dist = dist, return_values = T)
par(family = 'LM Roman 10', mfrow = c(1, 3))
pL <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "L", title = "Net Survival (.025)", commom_legend = T)
pM <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "M", title = "Net Survival (mean)", commom_legend = T)
pU <- plot_map(map = map, obj = netSur, t = which(time == 1), summary = "U", title = "Net Survival (.975)", commom_legend = T)
grid.arrange(pL, pM, pU, nrow = 1, ncol = 3)
source("header.R")
data <- readRDS(file = "DATA/leuk.rds")
# Optional
data$age <- scale(data$age)
data$wbc <- scale(data$wbc)
data$dep <- scale(data$dep)
map <- readRDS(file = "DATA/nwengland_map.rds")
adj_info <- adj_list(map = map)
model <- "PGWABXX"
dist <- gsub(pattern = "_", replacement = "", x = substring(text = model, first = c(1, 4), last = c(3, 7))[1])
d <- data_stan(data = data, model = model, cov.tilde = c("age"), cov = c("age", "wbc", "sex", "dep"), nonlinear = c(), adj_info = adj_info)
r <- fit_stan(data = d, model = model)
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
a <- seq(0, 5, 0.1)
a
plot(a, pnorm(a))
plot(a, qnorm(a))
plot(a, dnorm(a))
plot(a, dlnorm(a))
plot(a, dlnorm(a, 0, 5))
plot(a, dlnorm(a, 0, 5), type = 'l')
plot(a, log(dnorm(a, 0, 5)), type = 'l')
hist(rnorm(1000))
hist(log(rnorm(1000)))
hist(log(rnorm(1000))
hist(log(rnorm(1000)))
hist(log(rnorm(1000)))
hist(log(rnorm(1000)))
hist(norm(10000))
hist(norm(10000)))
hist(rnorm(10000))
hist(exp(rnorm(10000)))
hist((rlnorm(10000)))
hist((rlnorm(10000)), ylim = c(0, 10))
hist((rlnorm(10000)), xlim = c(0, 10))
hist((rlnorm(10000)), xlim = c(0, 10), bins = 100)
hist((rlnorm(10000)), xlim = c(0, 10), breaks = seq(0, 10, 0.5))
hist((rlnorm(10000)), xlim = c(0, 10), breaks = seq(0, 10, 1))
hist((rlnorm(10000)), xlim = c(0, 10)
)
hist((rlnorm(10000)), xlim = c(0, 10)
)
hist((rlnorm(10000)), xlim = c(0, 10))
hist((rlnorm(10000)), xlim = c(0, 10))
hist(exo(norm(10000)), xlim = c(0, 10))
hist(exp(norm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5)), xlim = c(0, 10))
hist(exp(rnorm(10000, 0, 5))
hist(exp(rnorm(10000, 0, 5))
hist(exp(rnorm(10000, 0, 5)))
plot(a, dnorm(x), type = 'l')
plot(a, dnorm(a), type = 'l')
plot(a, dnorm(a, 0, 5), type = 'l')
a <- seq(0, 10, 0.005)
plot(a, dnorm(a, 0, 5), type = 'l')
plot(a, dlnorm(a, 0, 5), type = 'l')
plot(a, dlnorm(a, 0, 1), type = 'l')
plot(a, dlnorm(a, 0, 5), type = 'l')
?dlnorm
plot(a, dlnorm(a, 0, exp(5)), type = 'l')
plot(a, dlnorm(a, 0, exp(1)), type = 'l')
plot(a, dlnorm(a, 0, exp(5)), type = 'l')
plot(a, dlnorm(a, 0, 1, type = 'l')
plot(a, dlnorm(a, 0, 1, type = 'l', log.p = F)
plot(a, dlnorm(a, 0, 1, type = 'l', log.p = F))
plot(a, dlnorm(a, 0, 1, log.p = F))
plot(a, dlnorm(a, 0, 1, log = F))
plot(a, dlnorm(a, 0, 1, log = F), type = 'l')
plot(a, dlnorm(a, 0, 5, log = F), type = 'l')
plot(a, dlnorm(a, 0, log(5), log = F), type = 'l')
plot(a, dlnorm(a, 0, log(1), log = F), type = 'l')
n <- rlnorm(1000, 0, 5)
sd(n)
log(sd(n))
n <- rlnorm(100000, 0, 5)
sd(n)
log(sd(n))
sd(log(n))
?dlnorm
lnprior <- Vectorize(function(t) dnorm(log(t), 0, 5)/t)
curve(lnprior, 0, 10, n = 1000, lwd = 2)
lnprior <- Vectorize(function(t) dnorm(log(t), 0, 1)/t)
curve(lnprior, 0, 10, n = 1000, lwd = 2)
Ç
Mohammed Alsaleem
hcprior <- Vectorize(function(t) dcauchy(t, 0, 1))
curve(hcprior, 0, 10, n = 1000, lwd = 2)
z <- c(1,2,3)
w <- c(4, 5, 6)
outer(z, w)
z%o% w
diag(2)
diag(2, 5, 5)
library('dplyr')
?n_distinct
?smp1
r <- readRDS(file = paste("FITTED_MODELS/", "LN", "/", "LN_ABCD", ".rds", sep = ""))
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
r <- readRDS(file = paste("FITTED_MODELS/", "LN", "/", "LN_ABXD", ".rds", sep = ""))
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
r <- readRDS(file = paste("FITTED_MODELS/", "LN", "/", "LN_ABCD", ".rds", sep = ""))
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
r <- readRDS(file = paste("FITTED_MODELS/", "LN", "/", "LN_ABCC", ".rds", sep = ""))
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
r <- readRDS(file = paste("FITTED_MODELS/", "LN", "/", "LN_XBXD", ".rds", sep = ""))
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
r <- readRDS(file = paste("FITTED_MODELS/", "LN", "/", "LN_AACC", ".rds", sep = ""))
fit <- r$fit
print(fit, pars = c("log_lik"), include = F)
library(hhh4)
install.packages("hhh4")
library(surveillance)
data("measlesWeserEms")
measlesWeserEms
?measlesWeserEms
measlesWeserEms@
-
measlesWeserEms@observed
ncol(weser)
ncol(measlesWeserEms)
